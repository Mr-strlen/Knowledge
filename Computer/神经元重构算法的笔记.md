有关神经元重构算法的总结  
网址：https://blog.csdn.net/qq_39567625  
## APP算法
### 介绍
All-path pruning（APP）是一种基于图结构的3D神经元自动重建算法。该方法对由成像技术造成的低信噪比、模糊残缺的图像具有较强的鲁棒性。  
### APP算法流程
APP算法分为两个步骤：  
1. 采用最短路径算法生成ICR（initial over-complete reconstruction ）  
  选取soma或者图中强度最高的点作为seed种子点。并且选取整张图片的平均强度ta，将像素大于ta的部分归为前景部分（选取较小的阈值目的是尽可能追踪每一个前景部分）。前景部分生成一个无向图G，采用Dijkstra algorithm计算seed种子点到每个前景的最短路径，得到tree graph（ICR）。  
2. 对重建结果进行修剪：MCMR subgraph algorithm  
  修剪算法maximal-covering minimal redundant(MCMR) subgraph algorithm分为三个部分：暗叶节点修剪Dark-leaf pruning (DLP)、覆盖叶节点修剪Covered-leaf pruning (CLP)、中间节点修剪Inter-node pruning (INP)  
  - Dark-leaf pruning (DLP)：选取视觉最低可见强度（8比特的图像中一般为30）为阈值tv，删除ICR中所有强度低于tv的nodes。该步骤剔除在追踪过程中被归为前景的较暗“背景点”。  
  - Covered-leaf pruning (CLP)：该部分是为了修剪叶节点。从叶节点开始循环迭代计算相邻节点间的sphere覆盖率，当覆盖率大于给定阈值时，删除该节点。  
  - Inter-node pruning (INP) ：优化seed、branching nodes、leaf nodes间的连接关系， 使神经元枝干更“平滑”、“简洁”。 类似CLP的工作，从叶节点开始循环计算相邻节点间的sphere覆盖率，删除被过多覆盖的部分。
### 总结
APP是一种快速的神经元自动重建算法，对于局部最小值不敏感、不依赖于先验的模型，具有较好的跨越gap的能力（在追踪过程中先尽可能考虑覆盖所有点，然后再修剪）。在生成无向图G的过程，边距e不仅考虑了欧式距离，还限制了条件（the edge weight between bright voxels will have smaller value than that between dark voxels.），对于最终的结果还可进一步采用 the gradient descent based deformable curve optimization 对修剪结果进行优化。

## APP2算法
### 介绍
All-path pruning 2.0（APP2）是一种基于图结构的3D神经元快速自动重建算法。是目前速度最快的算法，能可靠地生成神经元重构的树状结构。  
APP2具有以下特点：第一，对灰度图像进行距离变换，而无需二值化处理；第二，追踪过程基于Fast Marching算法，计算代价小；第三，剪枝过程采用“长段优先分层“处理方式。  
### 算法流程
APP2算法包括三个步骤：距离变换GWDT(gray-weighted distance transform)、采用FM算法进行追踪、分层剪枝。  
1. 距离变换GWDT  
距离变换的目的在于增强靠近中心线上的图像强度，减小靠近边缘的图像强度。某点的GWDT的距离值定义为该点到背景的最短路径上的像素强度之和。（the distance value for each pixel is defined as the sum of image pixels’ intensity along the shortest path to background）  
首先选取一个较小的阈值区分前景、背景。选取所有背景点为seeds并标记为ALIVE，前景标记为FAR。遍历每一个边缘点（与FAR相邻的seeds），计算该点到领域的最小距离值，并将该领域点标为TRIAL，同时更新边缘的距离值。接着从这些被标为TRIAL的点开始计算其领域内的距离最小值点，并标记为TRIAL,并将前一个点标记为ALIVE,循环迭代该过程。选取距离变化后最大值的点为soma（或称root）  
2. 采用FM算法进行追踪  
追踪采用FM算法，并且在追踪过程中通过标记每个节点的parent节点从而构建神经元结构连接关系。然后从root点开始采用FM算法（类似距离变换的过程）进行最终，并根据连接关系生成重建结果。  
3. ”长段优先分层“剪枝  
- Hierarchical segments construction  
定义两个分叉点（branching nodes）间的部分为segment，将重建结果的segments按长度排序。具体实现过程可从每个叶节点开始，找到其最近的分叉点（每个分叉点连接至少两个segments），将短segment标记为长segement的child-segment，迭代这个过程。  
- Recursive pruning  
将APP的node-coverage-ratio推广为segment-coverage-ratio，计算两个segements的覆盖率，若大于阈值（一般取75%）则删除被覆盖的segement及其所有child-segments，迭代该过程。  

### 总结
APP2算法由于采用Fast Marching算法，计算代价小，处理速度快；在神经元追踪前对图像进行GWDT变换，使其符合神经元图像强度从中心线向外递减的一般规律，增强重建结果的鲁棒性。“长段优先分层”剪枝使得APP2算法相比APP1的后处理能力有较大提升。